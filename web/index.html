<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hollywood Animal — Save Editor (MVP)</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <header>
      <div class="header-left">
        <h1>Hollywood Animal — Save Editor (Alpha))</h1>
        <p>Edit your save file for the Hollywood Animal game by Weappy</p>
      </div>
      <button id="downloadBtn" class="primary-cta" disabled>Download Edited Save</button>
    </header>

    <section id="changesPanel" class="changes" hidden>
      <details open>
        <summary>Changes (<span id="changesCount">0</span>)</summary>
        <ul id="changesList"></ul>
      </details>
      <div class="changes-actions">
        <button id="undoBtn" class="secondary-cta" disabled>Undo</button>
        <button id="redoBtn" class="secondary-cta" disabled>Redo</button>
      </div>
    </section>

    <section id="loaders">
      <div class="loader">
        <h2>1) Load Save File</h2>
        <div id="dropZone" class="drop-zone" tabindex="0" aria-label="Drop save file here">
          <p>Drag & drop save JSON here, or</p>
          <input type="file" id="saveFileInput" accept="application/json,.json" />
          <p class="hint">Windows save location: <code>C:\Users\[user name]\AppData\LocalLow\Weappy\Hollywood Animal\Saves\Profiles\0</code></p>
        </div>
        <div style="margin-top:8px; display:flex; gap:8px; align-items:center;">
          <button id="reloadBtn" disabled>Reload Current Save</button>
        </div>
        <div id="saveMeta" class="meta"></div>
      </div>

      <div class="loader">
        <h2>2) Load Name Map</h2>
        <p class="hint">Tries to auto-load <code>data/CHARACTER_NAMES.json</code>. If it fails, provide it here:</p>
        <input type="file" id="namesFileInput" accept="application/json,.json" />
        <div id="namesMeta" class="meta"></div>
      </div>
    </section>

    <nav class="tabs" role="tablist" aria-label="Primary">
      <button id="tabbtn-studio" class="tab active" role="tab" aria-selected="true" data-tab="studio" aria-controls="tab-studio">Studio</button>
      <button id="tabbtn-actors" class="tab" role="tab" aria-selected="false" data-tab="actors" aria-controls="tab-actors">Actors</button>
      <button id="tabbtn-directors" class="tab" role="tab" aria-selected="false" data-tab="directors" aria-controls="tab-directors">Directors</button>
      <button id="tabbtn-producers" class="tab" role="tab" aria-selected="false" data-tab="producers" aria-controls="tab-producers">Producers</button>
      <button id="tabbtn-writers" class="tab" role="tab" aria-selected="false" data-tab="writers" aria-controls="tab-writers">Writers</button>
      <button id="tabbtn-editors" class="tab" role="tab" aria-selected="false" data-tab="editors" aria-controls="tab-editors">Editors</button>
      <button id="tabbtn-composers" class="tab" role="tab" aria-selected="false" data-tab="composers" aria-controls="tab-composers">Composers</button>
      <button id="tabbtn-cinematographers" class="tab" role="tab" aria-selected="false" data-tab="cinematographers" aria-controls="tab-cinematographers">Cinematographers</button>
      <button id="tabbtn-agents" class="tab" role="tab" aria-selected="false" data-tab="agents" aria-controls="tab-agents">Security Agents</button>
      <button id="tabbtn-executives" class="tab" role="tab" aria-selected="false" data-tab="executives" aria-controls="tab-executives">Executives</button>
      <button id="tabbtn-movies" class="tab" role="tab" aria-selected="false" data-tab="movies" aria-controls="tab-movies">Movies</button>
    </nav>

    <section id="tab-studio" class="tab-content active" role="tabpanel" aria-labelledby="tabbtn-studio">
      <section id="studioControls" class="controls" hidden>
        <div class="studio-grid">
          <div class="studio-field">
            <label for="studioBudgetInput">Budget <span class="formatted-val" id="studioBudgetFmt"></span></label>
            <div class="value-row">
              <input type="number" id="studioBudgetInput" placeholder="Budget" />
            </div>
          </div>
          <div class="studio-field">
            <label for="studioCashInput">Cash <span class="formatted-val" id="studioCashFmt"></span></label>
            <div class="value-row">
              <input type="number" id="studioCashInput" placeholder="Cash" />
            </div>
          </div>
          <div class="studio-field">
            <label for="studioReputationInput">Reputation <span class="formatted-val" id="studioReputationFmt"></span></label>
            <div class="value-row">
              <input type="number" id="studioReputationInput" step="0.001" placeholder="Reputation" />
            </div>
          </div>
          <div class="studio-field">
            <label for="studioInfluenceInput">Influence <span class="formatted-val" id="studioInfluenceFmt"></span></label>
            <div class="value-row">
              <input type="number" id="studioInfluenceInput" placeholder="Influence" />
            </div>
          </div>
        </div>
        <div id="studioStatus" class="status"></div>
      </section>
    </section>

    <section id="tab-actors" class="tab-content" role="tabpanel" aria-labelledby="tab-actors">
      <section id="controls" class="controls" hidden>
        <div class="control-row">
          <input type="text" id="searchInput" placeholder="Search actors by name..." />
          <div style="display:flex; align-items:center; gap:6px;">Game Year: <span id="gameYearText">—</span></div>
        </div>
        <div id="status" class="status"></div>
      </section>

      <section id="tableSection" hidden>
        <table id="actorsTable">
          <thead>
            <tr>
              <th style="min-width: 240px;" data-sort-key="name">Name</th>
              <th data-sort-key="age">Age</th>
              <th data-sort-key="skill">Acting Skill</th>
              <th data-sort-key="limit">Limit</th>
              <th data-sort-key="art">Artistic Appeal</th>
              <th data-sort-key="com">Commercial Appeal</th>
            </tr>
          </thead>
          <tbody id="actorsTbody"></tbody>
        </table>
      </section>
    </section>

    <section id="tab-directors" class="tab-content" role="tabpanel" aria-labelledby="tabbtn-directors">
      <div id="directorsPlaceholder" class="placeholder"></div>
      <section id="directorsControls" class="controls" hidden>
        <div class="control-row">
          <input type="text" id="directorsSearchInput" placeholder="Search directors by name..." />
          <div style="display:flex; align-items:center; gap:6px;">Game Year: <span id="gameYearText2">—</span></div>
        </div>
        <div id="directorsStatus" class="status"></div>
      </section>
      <section id="directorsTableSection" hidden>
        <table id="directorsTable">
          <thead>
            <tr>
              <th style="min-width: 240px;" data-sort-key="name">Name</th>
              <th data-sort-key="age">Age</th>
              <th data-sort-key="skill">Director Skill</th>
              <th data-sort-key="limit">Limit</th>
              <th data-sort-key="com">Commercial Appeal</th>
              <th data-sort-key="art">Artistic Appeal</th>
              <th data-sort-key="genres">Genres</th>
              <th data-sort-key="movies">Movies</th>
            </tr>
          </thead>
          <tbody id="directorsTbody"></tbody>
        </table>
      </section>
    </section>
    <section id="tab-producers" class="tab-content" role="tabpanel" aria-labelledby="tabbtn-producers">
      <div id="producersPlaceholder" class="placeholder"></div>
      <section id="producersControls" class="controls" hidden>
        <div class="control-row">
          <input type="text" id="producersSearchInput" placeholder="Search producers by name..." />
          <div style="display:flex; align-items:center; gap:6px;">Game Year: <span id="gameYearText3">—</span></div>
        </div>
        <div id="producersStatus" class="status"></div>
      </section>
      <section id="producersTableSection" hidden>
        <table id="producersTable">
          <thead>
            <tr>
              <th style="min-width: 240px;" data-sort-key="name">Name</th>
              <th data-sort-key="age">Age</th>
              <th data-sort-key="skill">Producer Skill</th>
              <th data-sort-key="limit">Limit</th>
              <th data-sort-key="genres">Genres</th>
              <th data-sort-key="movies">Movies</th>
            </tr>
          </thead>
          <tbody id="producersTbody"></tbody>
        </table>
      </section>
    </section>
    <section id="tab-writers" class="tab-content" role="tabpanel" aria-labelledby="tabbtn-writers">
      <div id="writersPlaceholder" class="placeholder"></div>
      <section id="writersControls" class="controls" hidden>
        <div class="control-row">
          <input type="text" id="writersSearchInput" placeholder="Search writers by name..." />
          <div style="display:flex; align-items:center; gap:6px;">Game Year: <span id="gameYearText4">—</span></div>
        </div>
        <div id="writersStatus" class="status"></div>
      </section>
      <section id="writersTableSection" hidden>
        <table id="writersTable">
          <thead>
            <tr>
              <th style="min-width: 240px;" data-sort-key="name">Name</th>
              <th data-sort-key="age">Age</th>
              <th data-sort-key="skill">Writer Skill</th>
              <th data-sort-key="limit">Limit</th>
              <th data-sort-key="movies">Movies</th>
            </tr>
          </thead>
          <tbody id="writersTbody"></tbody>
        </table>
      </section>
    </section>
    <section id="tab-editors" class="tab-content" role="tabpanel" aria-labelledby="tabbtn-editors">
      <div id="editorsPlaceholder" class="placeholder"></div>
      <section id="editorsControls" class="controls" hidden>
        <div class="control-row">
          <input type="text" id="editorsSearchInput" placeholder="Search editors by name..." />
          <div style="display:flex; align-items:center; gap:6px;">Game Year: <span id="gameYearText5">—</span></div>
        </div>
        <div id="editorsStatus" class="status"></div>
      </section>
      <section id="editorsTableSection" hidden>
        <table id="editorsTable">
          <thead>
            <tr>
              <th style="min-width: 240px;" data-sort-key="name">Name</th>
              <th data-sort-key="age">Age</th>
              <th data-sort-key="skill">Editor Skill</th>
              <th data-sort-key="limit">Limit</th>
              <th data-sort-key="movies">Movies</th>
            </tr>
          </thead>
          <tbody id="editorsTbody"></tbody>
        </table>
      </section>
    </section>
    <section id="tab-composers" class="tab-content" role="tabpanel" aria-labelledby="tabbtn-composers">
      <div id="composersPlaceholder" class="placeholder"></div>
      <section id="composersControls" class="controls" hidden>
        <div class="control-row">
          <input type="text" id="composersSearchInput" placeholder="Search composers by name..." />
          <div style="display:flex; align-items:center; gap:6px;">Game Year: <span id="gameYearText6">—</span></div>
        </div>
        <div id="composersStatus" class="status"></div>
      </section>
      <section id="composersTableSection" hidden>
        <table id="composersTable">
          <thead>
            <tr>
              <th style="min-width: 240px;" data-sort-key="name">Name</th>
              <th data-sort-key="age">Age</th>
              <th data-sort-key="skill">Composer Skill</th>
              <th data-sort-key="limit">Limit</th>
              <th data-sort-key="movies">Movies</th>
            </tr>
          </thead>
          <tbody id="composersTbody"></tbody>
        </table>
      </section>
    </section>
    <section id="tab-cinematographers" class="tab-content" role="tabpanel" aria-labelledby="tabbtn-cinematographers">
      <div id="cinematographersPlaceholder" class="placeholder"></div>
      <section id="cinematographersControls" class="controls" hidden>
        <div class="control-row">
          <input type="text" id="cinematographersSearchInput" placeholder="Search cinematographers by name..." />
          <div style="display:flex; align-items:center; gap:6px;">Game Year: <span id="gameYearText7">—</span></div>
        </div>
        <div id="cinematographersStatus" class="status"></div>
      </section>
      <section id="cinematographersTableSection" hidden>
        <table id="cinematographersTable">
          <thead>
            <tr>
              <th style="min-width: 240px;" data-sort-key="name">Name</th>
              <th data-sort-key="age">Age</th>
              <th data-sort-key="skill">Cinematographer Skill</th>
              <th data-sort-key="limit">Limit</th>
              <th data-sort-key="movies">Movies</th>
            </tr>
          </thead>
          <tbody id="cinematographersTbody"></tbody>
        </table>
      </section>
    </section>
    <section id="tab-agents" class="tab-content" role="tabpanel" aria-labelledby="tabbtn-agents">
      <div id="agentsPlaceholder" class="placeholder"></div>
      <section id="agentsControls" class="controls" hidden>
        <div class="control-row">
          <input type="text" id="agentsSearchInput" placeholder="Search agents by name..." />
          <div style="display:flex; align-items:center; gap:6px;">Game Year: <span id="gameYearText8">—</span></div>
        </div>
        <div id="agentsStatus" class="status"></div>
      </section>
      <section id="agentsTableSection" hidden>
        <table id="agentsTable">
          <thead>
            <tr>
              <th style="min-width: 240px;" data-sort-key="name">Name</th>
              <th data-sort-key="age">Age</th>
              <th data-sort-key="skill">Security Agent Skill</th>
              <th data-sort-key="limit">Limit</th>
              <th data-sort-key="movies">Movies</th>
            </tr>
          </thead>
          <tbody id="agentsTbody"></tbody>
        </table>
      </section>
    </section>
    <section id="tab-executives" class="tab-content" role="tabpanel" aria-labelledby="tabbtn-executives">
      <div id="executivesPlaceholder" class="placeholder"></div>
      <section id="executivesControls" class="controls" hidden>
        <div class="control-row">
          <input type="text" id="executivesSearchInput" placeholder="Search executives by name..." />
          <div style="display:flex; align-items:center; gap:6px;">Game Year: <span id="gameYearText9">—</span></div>
        </div>
        <div id="executivesStatus" class="status"></div>
      </section>
      <section id="executivesTableSection" hidden>
        <table id="executivesTable">
          <thead>
            <tr>
              <th style="min-width: 240px;" data-sort-key="name">Name</th>
              <th data-sort-key="age">Age</th>
              <th data-sort-key="dept">Department</th>
              <th data-sort-key="level">Level</th>
              <th data-sort-key="exp">EXP</th>
              <th data-sort-key="mood">Happiness</th>
              <th data-sort-key="attitude">Morale</th>
              <th data-sort-key="umoney">Upgrade-Money</th>
              <th data-sort-key="uinfluence">Upgrade-Influence</th>
            </tr>
          </thead>
          <tbody id="executivesTbody"></tbody>
        </table>
      </section>
    </section>
    <section id="tab-movies" class="tab-content" role="tabpanel" aria-labelledby="tabbtn-movies">
      <div id="moviesPlaceholder" class="placeholder"></div>
      <section id="moviesControls" class="controls" hidden>
        <div class="control-row">
          <input type="text" id="moviesSearchInput" placeholder="Search movies by title..." />
          <div id="moviesStatus" class="status"></div>
        </div>
      </section>
      <section id="moviesTableSection" hidden>
        <table id="moviesTable">
          <thead>
            <tr>
              <th style="min-width: 260px;" data-sort-key="title">Title</th>
              <th data-sort-key="year">Year</th>
              <th data-sort-key="art">Artistic Appeal</th>
              <th data-sort-key="com">Commercial Appeal</th>
              <th data-sort-key="box">Box Office</th>
            </tr>
          </thead>
          <tbody id="moviesTbody"></tbody>
        </table>
      </section>
    </section>

    <!-- Advanced Detail Editor Overlay -->
    <div id="detailOverlay" class="overlay" hidden role="dialog" aria-modal="true" aria-labelledby="detailTitle">
      <div class="overlay-dialog">
        <div class="overlay-header">
          <h3 id="detailTitle">Advanced Editor</h3>
          <button id="detailCloseBtn" aria-label="Close">✕</button>
        </div>
        <p class="overlay-warning">For advanced users only. Editing raw data may break your save if used incorrectly. Proceed with caution and make backups.</p>
        <div class="overlay-meta">
          <div><strong>Name:</strong> <span id="detailName">—</span></div>
          <div><strong>ID:</strong> <span id="detailId">—</span></div>
          <div id="detailStatus" class="status"></div>
        </div>
        <div id="detailForm">
          <div class="controls" style="border:none; background:transparent; padding:8px 14px;">
            <div class="detail-grid">
              <div class="detail-field">
                <label for="detailCustomName">Custom Name</label>
                <div class="value-row"><input type="text" id="detailCustomName" placeholder="Custom name (optional)" /></div>
              </div>
              <div class="detail-field">
                <label>Gender</label>
                <div class="value-row">
                  <label class="muted"><input type="radio" name="detailGender" id="detailGender0" value="0" /> Male</label>
                  <label class="muted"><input type="radio" name="detailGender" id="detailGender1" value="1" /> Female</label>
                </div>
              </div>
              <div class="detail-field">
                <label for="detailStudioId">Studio <span class="muted">(temporarily read-only; PL = Player Studio)</span></label>
                <div class="value-row">
                  <select id="detailStudioId" disabled></select>
                </div>
              </div>
              <div class="detail-field">
                <label for="detailMood">Happiness <span class="formatted-val" id="detailMoodFmt"></span></label>
                <div class="value-row"><input type="range" id="detailMood" min="0" max="1" step="0.001" /><span class="detail-slider-val" id="detailMoodNum"></span></div>
              </div>
              <div class="detail-field">
                <label for="detailAttitude">Loyalty <span class="formatted-val" id="detailAttitudeFmt"></span></label>
                <div class="value-row"><input type="range" id="detailAttitude" min="0" max="1" step="0.001" /><span class="detail-slider-val" id="detailAttitudeNum"></span></div>
              </div>
              <div class="detail-field">
                <label for="detailSelfEsteem">Self Esteem <span class="formatted-val" id="detailSelfEsteemFmt"></span></label>
                <div class="value-row"><input type="range" id="detailSelfEsteem" min="-1" max="1" step="0.001" /><span class="detail-slider-val" id="detailSelfEsteemNum"></span></div>
              </div>
              <div class="detail-field">
                <label for="detailReadiness">Readiness for Tricks</label>
                <div class="value-row"><input type="number" id="detailReadiness" /></div>
              </div>
              <div class="detail-field">
                <label for="detailState">State <span class="hint">("0" = free agent, "2" = Player Studio)</span></label>
                <div class="value-row"><input type="text" id="detailState" /></div>
              </div>
              <div class="detail-field">
                <label for="detailSkill">Skill <span class="formatted-val" id="detailSkillFmt"></span></label>
                <div class="value-row"><input type="range" id="detailSkill" min="0" max="1" step="0.001" /><span class="detail-slider-val" id="detailSkillNum"></span></div>
              </div>
              <div class="detail-field">
                <label for="detailLimit">Limit <span class="formatted-val" id="detailLimitFmt"></span></label>
                <div class="value-row"><input type="range" id="detailLimit" min="0" max="1" step="0.001" /><span class="detail-slider-val" id="detailLimitNum"></span></div>
              </div>
              <div class="detail-field" id="detailArtWrap" hidden>
                <label for="detailArt">Artistic Appeal <span class="formatted-val" id="detailArtFmt"></span></label>
                <div class="value-row"><input type="range" id="detailArt" min="0" max="1" step="0.001" list="art-com-ticks" /><span class="detail-slider-val" id="detailArtNum"></span></div>
              </div>
              <div class="detail-field" id="detailComWrap" hidden>
                <label for="detailCom">Commercial Appeal <span class="formatted-val" id="detailComFmt"></span></label>
                <div class="value-row"><input type="range" id="detailCom" min="0" max="1" step="0.001" list="art-com-ticks" /><span class="detail-slider-val" id="detailComNum"></span></div>
              </div>
            </div>
            <a id="detailAdvancedLink" class="danger-link" href="javascript:void(0)">Direct JSON edit (advanced users only!)</a>
          </div>
        </div>
        <textarea id="detailJson" spellcheck="false" hidden></textarea>
        <div class="overlay-actions">
          <button id="detailFormatBtn" class="secondary-cta">Format</button>
          <button id="detailCopyBtn" class="secondary-cta">Copy JSON</button>
          <span style="flex:1"></span>
          <button id="detailCancelBtn">Cancel</button>
          <button id="detailApplyBtn" class="primary-cta">Apply Changes</button>
        </div>
      </div>
    </div>

    <footer>
      <p class="note">Tip: If opening this file directly (file://), browsers may block auto-loading <code>data/CHARACTER_NAMES.json</code>. Use the Name Map loader above or serve locally (e.g., <code>python -m http.server</code>).</p>
    </footer>

    <script src="./app.js"></script>
  </body>
  </html>
